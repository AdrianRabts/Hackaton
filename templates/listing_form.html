{% extends "base.html" %}
{% block content %}
<div class="bg-white border rounded-2xl p-6 max-w-2xl">
  <h1 class="text-2xl font-bold">
    {% if mode == "create" %}Nuevo lugar{% else %}Editar lugar{% endif %}
  </h1>

  <form class="mt-6 grid gap-3" method="post" action="{% if mode == 'create' %}/listings{% else %}/listings/{{ listing.id }}/update{% endif %}">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <div>
        <label class="text-sm text-slate-600">Ruta</label>
        <input name="route" required value="{{ listing.route if listing else '' }}" class="w-full px-3 py-2 border rounded-lg" placeholder="Cuenca / Tena / Ruta Spondylus..." />
      </div>
      <div>
        <label class="text-sm text-slate-600">Categoría</label>
        <select name="category" required class="w-full px-3 py-2 border rounded-lg">
          {% set current = listing.category if listing else '' %}
          {% for c in ["comida","historico","parque","artesania"] %}
          <option value="{{ c }}" {% if c == current %}selected{% endif %}>{{ c }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div>
      <label class="text-sm text-slate-600">Título</label>
      <input name="title" required value="{{ listing.title if listing else '' }}" class="w-full px-3 py-2 border rounded-lg" placeholder="Ej: Taller artesanal..." />
    </div>

    <div>
      <label class="text-sm text-slate-600">Descripción corta</label>
      <textarea name="short_desc" required class="w-full px-3 py-2 border rounded-lg" rows="3">{{ listing.short_desc if listing else '' }}</textarea>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <div>
        <label class="text-sm text-slate-600">Precio USD</label>
        <input type="number" step="0.01" min="0" name="price_usd" required value="{{ listing.price_usd if listing else 0 }}" class="w-full px-3 py-2 border rounded-lg" />
      </div>
      <div>
        <label class="text-sm text-slate-600">Duración (min)</label>
        <input type="number" min="0" name="duration_min" required value="{{ listing.duration_min if listing else 0 }}" class="w-full px-3 py-2 border rounded-lg" />
      </div>
    </div>

    <div>
      <label class="text-sm text-slate-600">Dirección</label>
      <input name="address" required value="{{ listing.address if listing else '' }}" class="w-full px-3 py-2 border rounded-lg" />
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <div>
        <label class="text-sm text-slate-600">Google Maps URL</label>
        <input name="maps_url" value="{{ listing.maps_url if listing else '' }}" class="w-full px-3 py-2 border rounded-lg" />
      </div>
      <div>
        <label class="text-sm text-slate-600">WhatsApp contacto</label>
        <input name="contact_whatsapp" value="{{ listing.contact_whatsapp if listing else '' }}" class="w-full px-3 py-2 border rounded-lg" placeholder="+593..." />
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <div>
        <label class="text-sm text-slate-600">TikTok URL (opcional)</label>
        <input name="tiktok_url" value="{{ listing.tiktok_url if listing else '' }}" class="w-full px-3 py-2 border rounded-lg" />
      </div>
      <div>
        <label class="text-sm text-slate-600">Tags (coma)</label>
        <input name="tags" value="{{ listing.tags_str if listing else '' }}" class="w-full px-3 py-2 border rounded-lg" placeholder="autentico, compra_local..." />
      </div>
    </div>

    <div class="flex gap-2 mt-3">
      <button class="px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800">
        {% if mode == "create" %}Crear{% else %}Guardar{% endif %}
      </button>
      <a href="/listings" class="px-4 py-2 rounded-lg bg-white border hover:bg-slate-100">Cancelar</a>
    </div>
  </form>
</div>
{% endblock %}
